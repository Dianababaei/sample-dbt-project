{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-24T22:59:30.192901Z", "invocation_id": "600fbe19-4239-489d-8de8-80bd347e12ee", "invocation_started_at": "2026-01-24T22:59:22.643891Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.067668Z", "completed_at": "2026-01-24T22:59:28.099048Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.101050Z", "completed_at": "2026-01-24T22:59:28.101050Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04338383674621582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.bain_capital_portfolio_analytics.optimization_opportunities", "compiled": true, "compiled_code": "/*\r\n================================================================================\r\nARTEMIS OPTIMIZATION OPPORTUNITIES ANALYSIS\r\n================================================================================\r\n\r\nThis file documents the optimization opportunities that Artemis should identify\r\nand fix when processing this dbt project.\r\n\r\n================================================================================\r\nPIPELINE A: SIMPLE CASHFLOW PIPELINE (4 models)\r\n================================================================================\r\n\r\nModel: stg_cashflows\r\n----------------------\r\nIssues:\r\n1. Unnecessary DISTINCT on source (source already unique by PK)\r\n2. Filter applied AFTER transformations (should filter first)\r\n3. Type casting could be pushed to source definition\r\n\r\nSuggested Optimization:\r\n- Remove DISTINCT\r\n- Move WHERE clause to first CTE\r\n- Use QUALIFY if deduplication needed\r\n\r\nModel: stg_portfolios\r\n----------------------\r\nIssues:\r\n1. Deduplication uses subquery + WHERE instead of QUALIFY\r\n2. Multiple CTEs for simple operations\r\n\r\nSuggested Optimization:\r\n- Use QUALIFY row_number() over (...) = 1\r\n- Combine CTEs\r\n\r\nModel: fact_cashflow_summary\r\n-----------------------------\r\nIssues:\r\n1. Full row-level join before aggregation (scans all rows)\r\n2. Date dimensions calculated per row\r\n3. Non-descriptive GROUP BY (uses column numbers)\r\n\r\nSuggested Optimization:\r\n- Aggregate cashflows FIRST, then join to portfolios\r\n- Calculate date dimensions once\r\n- Use explicit column names in GROUP BY\r\n\r\nModel: report_monthly_cashflows\r\n--------------------------------\r\nIssues:\r\n1. Re-aggregates already aggregated fact data\r\n2. Multiple identical window function partitions\r\n3. LAG functions calculated separately\r\n\r\nSuggested Optimization:\r\n- Reference pre-aggregated data where possible\r\n- Consolidate window functions with same PARTITION BY/ORDER BY\r\n- Use single window clause with multiple functions\r\n\r\n================================================================================\r\nPIPELINE B: TRADE ANALYTICS PIPELINE (10 models)\r\n================================================================================\r\n\r\nModel: stg_trades\r\n------------------\r\nIssues:\r\n1. Repeated CASE statements for categorization (duplicated in other models)\r\n2. Multiple CTEs for sequential transformations\r\n3. Late filtering (filter applied after all transformations)\r\n\r\nSuggested Optimization:\r\n- Extract trade categorization to macro\r\n- Combine transformations\r\n- Filter in first CTE\r\n\r\nModel: stg_securities\r\n----------------------\r\nIssues:\r\n1. Nested subquery for deduplication\r\n2. Repeated CASE for type standardization (similar to other models)\r\n\r\nSuggested Optimization:\r\n- Use QUALIFY\r\n- Create macro for security type standardization\r\n\r\nModel: stg_market_prices\r\n-------------------------\r\nIssues:\r\n1. SELF-JOIN for prior day prices (very expensive)\r\n2. Multiple window functions with same partition\r\n3. Additional CTE for derived calculations\r\n\r\nSuggested Optimization:\r\n- Use LAG() instead of self-join\r\n- Consolidate window functions\r\n- Combine CTEs\r\n\r\nModel: int_trades_enriched\r\n---------------------------\r\nIssues:\r\n1. 4-way join (trades + securities + brokers + market_prices)\r\n2. Price lookup done row-by-row\r\n3. Calculations done per trade row\r\n\r\nSuggested Optimization:\r\n- Pre-aggregate market prices if possible\r\n- Consider materialization strategy\r\n- Push some calculations upstream\r\n\r\nModel: int_trade_pnl\r\n---------------------\r\nIssues:\r\n1. Multiple window functions with identical PARTITION BY/ORDER BY\r\n2. Separate CTEs for each calculation layer\r\n3. Complex running position logic\r\n\r\nSuggested Optimization:\r\n- Consolidate window functions into single SELECT\r\n- Use Snowflake's multi-column window functions\r\n- Simplify CTE structure\r\n\r\nModel: fact_trade_summary\r\n--------------------------\r\nIssues:\r\n1. Re-joins portfolio data (already available upstream)\r\n2. Redundant date extractions (already done in staging)\r\n3. Surrogate key generation overhead\r\n\r\nSuggested Optimization:\r\n- Pass portfolio attributes through from upstream\r\n- Reuse date dimensions from staging\r\n- Consider if surrogate key is necessary\r\n\r\nModel: fact_portfolio_positions\r\n--------------------------------\r\nIssues:\r\n1. Double subquery pattern for \"latest\" records\r\n2. Market prices joined inefficiently\r\n\r\nSuggested Optimization:\r\n- Use QUALIFY for latest positions\r\n- Pre-compute latest market prices in separate CTE\r\n- Consider incremental materialization\r\n\r\nModel: report_trading_performance\r\n----------------------------------\r\nIssues:\r\n1. Re-aggregates fact data by portfolio/month\r\n2. Joins positions and trades separately\r\n3. Multiple LAG functions\r\n\r\nSuggested Optimization:\r\n- Create intermediate aggregation layer\r\n- Join once with all needed dimensions\r\n- Consolidate window calculations\r\n\r\n================================================================================\r\nPIPELINE C: COMPLEX PORTFOLIO ANALYTICS (20 models)\r\n================================================================================\r\n\r\nGeneral DAG-Level Issues:\r\n-------------------------\r\n1. Position attribution calculated per-day, then re-aggregated to sector\r\n2. Risk metrics and performance metrics calculated in parallel but not shared\r\n3. Benchmark alignment done for each portfolio-date combination (expensive)\r\n4. Fund roll-up happens late, after all portfolio calculations\r\n5. Report models re-aggregate fact tables\r\n\r\nModel: int_portfolio_returns_daily\r\n-----------------------------------\r\nIssues:\r\n1. Self-join for prior day NAV (should use LAG)\r\n2. 7 separate window functions for rolling returns\r\n3. 2 additional window functions for volatility\r\n4. All use same PARTITION BY/ORDER BY\r\n\r\nSuggested Optimization:\r\n- Use LAG() for prior NAV\r\n- Create single window definition\r\n- Compute all rolling metrics in one pass\r\n\r\nModel: int_benchmark_aligned\r\n-----------------------------\r\nIssues:\r\n1. Cross-join-like pattern (portfolio dates \u00d7 benchmarks)\r\n2. Could pre-filter to active benchmarks only\r\n\r\nSuggested Optimization:\r\n- Filter benchmarks before join\r\n- Consider materialization strategy\r\n- Index on benchmark_id + date\r\n\r\nModel: int_portfolio_vs_benchmark\r\n----------------------------------\r\nIssues:\r\n1. Joins data already joined in upstream models\r\n2. Excess return calculated multiple times\r\n3. Rolling tracking error requires another window pass\r\n\r\nSuggested Optimization:\r\n- Pass benchmark data through from earlier\r\n- Calculate excess returns once\r\n- Combine tracking error with other window calcs\r\n\r\nModel: int_position_attribution\r\n--------------------------------\r\nIssues:\r\n1. 3-way join (positions + securities + prices)\r\n2. Window functions for prior weight\r\n3. Attribution calculated per position\r\n\r\nSuggested Optimization:\r\n- Consider different join order\r\n- Pre-aggregate where possible\r\n- Brinson attribution could be modularized\r\n\r\nModel: int_sector_attribution\r\n------------------------------\r\nIssues:\r\n1. Re-aggregates position attribution\r\n2. Multiple window functions for rolling\r\n3. Separate calculation from position level\r\n\r\nSuggested Optimization:\r\n- Consider pushing sector aggregation upstream\r\n- Combine with position attribution model\r\n- Reduce number of CTEs\r\n\r\nModel: int_risk_metrics\r\n------------------------\r\nIssues:\r\n1. Multiple window functions for risk calcs\r\n2. VaR calculated after other metrics (extra pass)\r\n3. Max drawdown requires running max\r\n\r\nSuggested Optimization:\r\n- Consolidate risk calculations\r\n- Compute VaR alongside volatility\r\n- Single window definition for all\r\n\r\nModel: int_fund_rollup\r\n-----------------------\r\nIssues:\r\n1. Gets latest metrics via subquery (should use QUALIFY)\r\n2. Aggregates after joining\r\n3. Weighted average calculations\r\n\r\nSuggested Optimization:\r\n- Use QUALIFY for latest\r\n- Aggregate first, then join hierarchy\r\n- Simplify weighted calcs\r\n\r\nModel: fact_portfolio_performance\r\n----------------------------------\r\nIssues:\r\n1. Joins benchmark and risk data that share same key\r\n2. Portfolio attributes added at end\r\n3. Date extractions repeated\r\n\r\nSuggested Optimization:\r\n- Single join for all metrics\r\n- Push portfolio join upstream\r\n- Calculate dates once in staging\r\n\r\nModel: report_ic_dashboard\r\n---------------------------\r\nIssues:\r\n1. Gets \"latest\" via subquery (3 times!)\r\n2. Re-aggregates positions for summary\r\n3. Sector concentration via nested query\r\n4. Multiple ranking functions\r\n\r\nSuggested Optimization:\r\n- Use QUALIFY for latest records\r\n- Create intermediate \"latest portfolio state\" model\r\n- Pre-compute sector concentrations\r\n- Combine rankings\r\n\r\nModel: report_lp_quarterly\r\n---------------------------\r\nIssues:\r\n1. Filters to quarter-end only (late in pipeline)\r\n2. Re-aggregates cashflows\r\n3. Multiple LAG functions for period comparisons\r\n4. TVPI/DPI calculated at end\r\n\r\nSuggested Optimization:\r\n- Filter earlier in pipeline\r\n- Pre-aggregate cashflows quarterly\r\n- Consolidate LAG calculations\r\n- Calculate investment metrics upstream\r\n\r\n================================================================================\r\nSNOWFLAKE-SPECIFIC OPTIMIZATIONS\r\n================================================================================\r\n\r\n1. QUALIFY Usage\r\n   - Every row_number() + WHERE rn=1 pattern should become QUALIFY\r\n   - Estimated models affected: 12\r\n\r\n2. Window Function Consolidation\r\n   - Models with 5+ window functions using same partition: 8\r\n   - Potential reduction: 40-60% of window function overhead\r\n\r\n3. Join Order Optimization\r\n   - Several multi-way joins could benefit from different join order\r\n   - Snowflake's join optimization works best with explicit hints\r\n\r\n4. Materialization Strategy\r\n   - Intermediate models: Consider TABLE instead of VIEW for heavy calcs\r\n   - Staging models: VIEW is appropriate\r\n   - Consider incremental for daily position/valuation models\r\n\r\n5. Clustering Keys\r\n   - fact_portfolio_performance: CLUSTER BY (portfolio_id, valuation_date)\r\n   - fact_position_snapshot: CLUSTER BY (portfolio_id, position_date)\r\n   - fact_trade_summary: CLUSTER BY (portfolio_id, trade_date)\r\n\r\n================================================================================\r\nCROSS-MODEL OPTIMIZATIONS\r\n================================================================================\r\n\r\n1. Shared Calculations\r\n   - Date dimensions calculated in 15+ places \u2192 extract to dim_date\r\n   - Trade categorization logic duplicated \u2192 extract to macro\r\n   - Deduplication pattern repeated \u2192 use QUALIFY consistently\r\n\r\n2. Pre-Aggregation Opportunities\r\n   - Daily position data \u2192 pre-aggregate to weekly/monthly\r\n   - Trade data \u2192 pre-aggregate to portfolio/security/period\r\n\r\n3. Intermediate Layer Restructure\r\n   - int_portfolio_returns_daily could include benchmark data\r\n   - int_position_attribution could include sector aggregation\r\n   - Single \"portfolio state\" model for latest data\r\n\r\n4. DAG Simplification\r\n   - Pipeline C has 7 intermediate models that could be reduced to 4\r\n   - Some fact tables could be combined\r\n\r\n================================================================================\r\nEXPECTED IMPROVEMENTS\r\n================================================================================\r\n\r\nConservative Estimates:\r\n- dbt run time: 30-50% reduction\r\n- Snowflake credits: 25-40% reduction\r\n- Query complexity: 40% fewer CTEs\r\n- Warehouse scan volume: 35% reduction\r\n\r\nFinancial Accuracy Validation:\r\n- Row counts must match pre/post optimization\r\n- Sum(NAV), Sum(PnL), Sum(cashflows) must match within tolerance\r\n- All dbt tests must pass\r\n- No silent drift in portfolio metrics\r\n\r\n================================================================================\r\n*/", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.084696Z", "completed_at": "2026-01-24T22:59:28.100152Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.103532Z", "completed_at": "2026-01-24T22:59:28.103532Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04385852813720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_benchmark_returns", "compiled": true, "compiled_code": "-- Pipeline C: Complex Portfolio Analytics\n-- Model: stg_benchmark_returns\n-- Description: Daily benchmark return data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Self-join for cumulative returns (inefficient)\n-- 2. Multiple window functions\n\nwith source as (\n    select\n        'BM' || lpad(benchmark_id, 3, '0') as benchmark_id,\n        return_date,\n        daily_return,\n        created_at\n    from BAIN_ANALYTICS.DEV.sample_benchmark_returns\n    where return_date >= '2020-01-01'\n),\n\n-- ISSUE: Multiple window functions that could be consolidated\nwith_cumulative as (\n    select\n        benchmark_id,\n        return_date,\n        daily_return,\n        -- ISSUE: Separate window functions for each period\n        exp(sum(ln(1 + daily_return)) over (\n            partition by benchmark_id\n            order by return_date\n            rows between unbounded preceding and current row\n        )) - 1 as cumulative_return,\n        exp(sum(ln(1 + daily_return)) over (\n            partition by benchmark_id\n            order by return_date\n            rows between 29 preceding and current row\n        )) - 1 as return_30d,\n        exp(sum(ln(1 + daily_return)) over (\n            partition by benchmark_id\n            order by return_date\n            rows between 89 preceding and current row\n        )) - 1 as return_90d,\n        stddev(daily_return) over (\n            partition by benchmark_id\n            order by return_date\n            rows between 251 preceding and current row\n        ) * sqrt(252) as annualized_volatility,\n        created_at\n    from source\n)\n\nselect * from with_cumulative", "relation_name": "BAIN_ANALYTICS.DEV.stg_benchmark_returns", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.089798Z", "completed_at": "2026-01-24T22:59:28.101050Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.105618Z", "completed_at": "2026-01-24T22:59:28.105618Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.043946027755737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_benchmarks", "compiled": true, "compiled_code": "-- Pipeline C: Complex Portfolio Analytics\n-- Model: stg_benchmarks\n-- Description: Benchmark index data for performance comparison\n\nwith source as (\n    select\n        benchmark_id,\n        benchmark_name,\n        benchmark_ticker,\n        benchmark_type,\n        currency,\n        is_active\n    from BAIN_ANALYTICS.DEV.sample_benchmarks\n)\n\nselect\n    benchmark_id,\n    trim(benchmark_name) as benchmark_name,\n    upper(trim(benchmark_ticker)) as benchmark_ticker,\n    upper(benchmark_type) as benchmark_type,\n    upper(currency) as currency,\n    is_active\nfrom source\nwhere is_active = true", "relation_name": "BAIN_ANALYTICS.DEV.stg_benchmarks", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.094169Z", "completed_at": "2026-01-24T22:59:28.102051Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.108636Z", "completed_at": "2026-01-24T22:59:28.108636Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.04596900939941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_brokers", "compiled": true, "compiled_code": "-- Pipeline B: Trade Analytics Pipeline\n-- Model: stg_brokers\n-- Description: Staging model for broker information\n\nwith source as (\n    select\n        broker_id,\n        broker_name,\n        created_at\n    from BAIN_ANALYTICS.DEV.sample_brokers\n)\n\nselect\n    broker_id,\n    trim(broker_name) as broker_name,\n    created_at\nfrom source", "relation_name": "BAIN_ANALYTICS.DEV.stg_brokers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.120717Z", "completed_at": "2026-01-24T22:59:28.133534Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.139333Z", "completed_at": "2026-01-24T22:59:28.139333Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026793479919433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_cashflows", "compiled": true, "compiled_code": "-- Pipeline A: Simple Cashflow Pipeline\n-- Model: stg_cashflows\n-- Description: Staging model for raw cashflow data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Unnecessary DISTINCT (source already unique)\n-- 2. Late filtering (should push date filter upstream)\n-- 3. Non-optimal date casting\n\nwith source as (\n    select distinct  -- ISSUE: Unnecessary DISTINCT, source has unique constraint\n        cashflow_id,\n        portfolio_id,\n        cashflow_type,\n        cashflow_date,\n        amount,\n        currency,\n        created_at,\n        updated_at\n    from BAIN_ANALYTICS.DEV.sample_cashflows\n),\n\n-- ISSUE: Heavy transformation before filtering\nconverted as (\n    select\n        cashflow_id,\n        'PF' || lpad(portfolio_id, 3, '0') as portfolio_id,\n        upper(cashflow_type) as cashflow_type,\n        cast(cashflow_date as date) as cashflow_date,\n        cast(amount as decimal(18,2)) as amount,\n        upper(currency) as currency,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from source\n),\n\n-- ISSUE: Filter applied after transformation, should be earlier\nfiltered as (\n    select *\n    from converted\n    where cashflow_date >= '2020-01-01'\n      and cashflow_date <= '2024-12-31'\n)\n\nselect * from filtered", "relation_name": "BAIN_ANALYTICS.DEV.stg_cashflows", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.125713Z", "completed_at": "2026-01-24T22:59:28.138240Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.141246Z", "completed_at": "2026-01-24T22:59:28.141246Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02662348747253418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_fund_hierarchy", "compiled": true, "compiled_code": "-- Pipeline C: Complex Portfolio Analytics\n-- Model: stg_fund_hierarchy\n-- Description: Fund and portfolio hierarchy for roll-up reporting\n\nwith source as (\n    select\n        entity_id,\n        entity_name,\n        entity_type,\n        parent_entity_id,\n        hierarchy_level,\n        is_active\n    from BAIN_ANALYTICS.DEV.sample_fund_hierarchy\n)\n\nselect\n    entity_id,\n    trim(entity_name) as entity_name,\n    upper(entity_type) as entity_type,\n    parent_entity_id,\n    hierarchy_level,\n    is_active\nfrom source\nwhere is_active = true", "relation_name": "BAIN_ANALYTICS.DEV.stg_fund_hierarchy", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.128853Z", "completed_at": "2026-01-24T22:59:28.140329Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.144329Z", "completed_at": "2026-01-24T22:59:28.144329Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02871847152709961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_market_prices", "compiled": true, "compiled_code": "-- Pipeline B: Trade Analytics Pipeline\n-- Model: stg_market_prices\n-- Description: Staging model for daily market prices\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Self-join for prior day prices (inefficient)\n-- 2. Late aggregation\n-- 3. Multiple window functions that could be consolidated\n\nwith source as (\n    select\n        security_id,\n        price_date,\n        close_price,\n        volume,\n        created_at\n    from BAIN_ANALYTICS.DEV.sample_market_prices\n    where price_date >= '2020-01-01'\n),\n\n-- ISSUE: Multiple separate window functions\nwith_returns as (\n    select\n        *,\n        -- ISSUE: These could be computed together\n        avg(close_price) over (\n            partition by security_id\n            order by price_date\n            rows between 19 preceding and current row\n        ) as ma_20,\n        avg(close_price) over (\n            partition by security_id\n            order by price_date\n            rows between 49 preceding and current row\n        ) as ma_50,\n        avg(volume) over (\n            partition by security_id\n            order by price_date\n            rows between 19 preceding and current row\n        ) as avg_volume_20d\n    from source\n),\n\n-- ISSUE: Another pass for more calculations\nfinal as (\n    select\n        *,\n        case\n            when volume > avg_volume_20d * 2 then 'HIGH'\n            when volume < avg_volume_20d * 0.5 then 'LOW'\n            else 'NORMAL'\n        end as volume_signal\n    from with_returns\n)\n\nselect * from final", "relation_name": "BAIN_ANALYTICS.DEV.stg_market_prices", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.133534Z", "completed_at": "2026-01-24T22:59:28.142322Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.147245Z", "completed_at": "2026-01-24T22:59:28.147245Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.02969980239868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_portfolio_benchmarks", "compiled": true, "compiled_code": "-- Pipeline C: Complex Portfolio Analytics\n-- Model: stg_portfolio_benchmarks\n-- Description: Mapping of portfolios to their benchmarks\n\nwith source as (\n    select\n        'PF' || lpad(portfolio_id, 3, '0') as portfolio_id,\n        'BM' || lpad(benchmark_id, 3, '0') as benchmark_id,\n        is_primary,\n        created_at\n    from BAIN_ANALYTICS.DEV.sample_portfolio_benchmarks\n)\n\nselect\n    portfolio_id,\n    benchmark_id,\n    is_primary,\n    created_at\nfrom source", "relation_name": "BAIN_ANALYTICS.DEV.stg_portfolio_benchmarks", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.154281Z", "completed_at": "2026-01-24T22:59:28.169745Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.181124Z", "completed_at": "2026-01-24T22:59:28.181124Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.032877206802368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_portfolios", "compiled": true, "compiled_code": "-- Pipeline A: Simple Cashflow Pipeline\n-- Model: stg_portfolios\n-- Description: Staging model for portfolio master data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Subquery for deduplication instead of QUALIFY\n-- 2. Multiple passes over data\n\nwith source as (\n    select\n        portfolio_id,\n        portfolio_name,\n        portfolio_type,\n        fund_id,\n        status,\n        aum_usd\n    from BAIN_ANALYTICS.DEV.sample_portfolios\n),\n\nactive_only as (\n    select *\n    from source\n    where status = 'ACTIVE'\n)\n\nselect * from active_only", "relation_name": "BAIN_ANALYTICS.DEV.stg_portfolios", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.162570Z", "completed_at": "2026-01-24T22:59:28.180025Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.186130Z", "completed_at": "2026-01-24T22:59:28.186130Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03644132614135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_positions_daily", "compiled": true, "compiled_code": "-- Pipeline C: Complex Portfolio Analytics\n-- Model: stg_positions_daily\n-- Description: Daily position snapshots from source system\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Heavy transformations before filtering\n-- 2. Unnecessary type conversions\n-- 3. Could push filters upstream\n\nwith source as (\n    select\n        position_id,\n        'PF' || lpad(portfolio_id, 3, '0') as portfolio_id,\n        'SEC' || lpad(security_id, 3, '0') as security_id,\n        position_date,\n        quantity,\n        market_value_usd,\n        created_at\n    from BAIN_ANALYTICS.DEV.sample_positions_daily\n),\n\n-- ISSUE: Transformations applied to all rows before filter\ntransformed as (\n    select\n        position_id,\n        portfolio_id,\n        security_id,\n        cast(position_date as date) as position_date,\n        cast(quantity as decimal(18,6)) as quantity,\n        cast(market_value_usd as decimal(18,2)) as market_value_usd,\n        created_at\n    from source\n),\n\n-- ISSUE: Filter applied last\nfiltered as (\n    select *\n    from transformed\n    where position_date >= '2020-01-01'\n)\n\nselect * from filtered", "relation_name": "BAIN_ANALYTICS.DEV.stg_positions_daily", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.170751Z", "completed_at": "2026-01-24T22:59:28.185035Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.190037Z", "completed_at": "2026-01-24T22:59:28.190037Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03733205795288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_securities", "compiled": true, "compiled_code": "-- Pipeline B: Trade Analytics Pipeline\n-- Model: stg_securities\n-- Description: Staging model for security master data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Nested subqueries instead of QUALIFY\n-- 2. Multiple deduplication passes\n\nwith source as (\n    select\n        security_id,\n        ticker,\n        security_name,\n        security_type,\n        asset_class,\n        sector,\n        industry,\n        country,\n        currency\n    from BAIN_ANALYTICS.DEV.sample_securities\n),\n\n-- ISSUE: Separate CTE for type standardization\nstandardized as (\n    select\n        security_id,\n        upper(trim(ticker)) as ticker,\n        trim(security_name) as security_name,\n        -- ISSUE: Repeated CASE logic found in other models\n        case\n            when security_type in ('STOCK', 'EQUITY', 'COMMON') then 'EQUITY'\n            when security_type in ('BOND', 'NOTE', 'DEBENTURE') then 'FIXED_INCOME'\n            when security_type in ('OPTION', 'FUTURE', 'SWAP') then 'DERIVATIVE'\n            when security_type in ('ETF', 'MUTUAL_FUND') then 'FUND'\n            else 'OTHER'\n        end as security_type_standardized,\n        security_type as security_type_original,\n        upper(asset_class) as asset_class,\n        sector,\n        industry,\n        upper(country) as country,\n        upper(currency) as currency\n    from source\n)\n\nselect * from standardized", "relation_name": "BAIN_ANALYTICS.DEV.stg_securities", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.174751Z", "completed_at": "2026-01-24T22:59:28.188127Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.192038Z", "completed_at": "2026-01-24T22:59:28.192038Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03775763511657715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_trades", "compiled": true, "compiled_code": "-- Pipeline B: Trade Analytics Pipeline\n-- Model: stg_trades\n-- Description: Staging model for trade transactions\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Complex CASE statements that repeat\n-- 2. Multiple CTEs doing similar transformations\n-- 3. Unnecessary string operations\n\nwith source as (\n    select\n        trade_id,\n        'PF' || lpad(portfolio_id, 3, '0') as portfolio_id,\n        'SEC' || lpad(security_id, 3, '0') as security_id,\n        trade_date,\n        trade_type,\n        quantity,\n        price,\n        net_amount,\n        broker_id,\n        created_at\n    from BAIN_ANALYTICS.DEV.sample_trades\n),\n\n-- ISSUE: Repeated CASE statements for trade categorization\ncategorized as (\n    select\n        *,\n        -- ISSUE: This logic is repeated in multiple models\n        case\n            when trade_type in ('BUY', 'COVER') then 'PURCHASE'\n            when trade_type in ('SELL', 'SHORT') then 'SALE'\n            when trade_type in ('DIVIDEND', 'INTEREST') then 'INCOME'\n            else 'OTHER'\n        end as trade_category,\n        case\n            when abs(net_amount) >= 10000000 then 'LARGE'\n            when abs(net_amount) >= 1000000 then 'MEDIUM'\n            when abs(net_amount) >= 100000 then 'SMALL'\n            else 'MICRO'\n        end as trade_size_bucket,\n        -- ISSUE: Redundant string manipulation\n        upper(trim(trade_type)) as trade_type_clean\n    from source\n),\n\n-- ISSUE: Another pass just for date calculations\nwith_dates as (\n    select\n        *,\n        date_trunc('month', trade_date) as trade_month,\n        date_trunc('quarter', trade_date) as trade_quarter,\n        extract(year from trade_date) as trade_year,\n        extract(month from trade_date) as trade_month_num,\n        dayofweek(trade_date) as trade_day_of_week\n    from categorized\n),\n\n-- ISSUE: Late filtering\nfiltered as (\n    select *\n    from with_dates\n    where trade_date >= '2020-01-01'\n)\n\nselect * from filtered", "relation_name": "BAIN_ANALYTICS.DEV.stg_trades", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.214259Z", "completed_at": "2026-01-24T22:59:28.217272Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.224272Z", "completed_at": "2026-01-24T22:59:28.224272Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02816033363342285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.dim_date", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.220281Z", "completed_at": "2026-01-24T22:59:28.222266Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.228270Z", "completed_at": "2026-01-24T22:59:28.228270Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02923417091369629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.sample_benchmark_returns", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.203501Z", "completed_at": "2026-01-24T22:59:28.223272Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.229340Z", "completed_at": "2026-01-24T22:59:28.229340Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03529953956604004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_valuations", "compiled": true, "compiled_code": "-- Pipeline C: Complex Portfolio Analytics\n-- Model: stg_valuations\n-- Description: Portfolio valuation data (NAV, etc.)\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Deduplication via subquery\n-- 2. Heavy calculations before filtering\n\nwith source as (\n    select\n        valuation_id,\n        'PF' || lpad(portfolio_id, 3, '0') as portfolio_id,\n        valuation_date,\n        nav,\n        nav_usd,\n        created_at\n    from BAIN_ANALYTICS.DEV.sample_valuations\n),\n\n-- ISSUE: Filter applied after deduplication\nfiltered as (\n    select\n        valuation_id,\n        portfolio_id,\n        cast(valuation_date as date) as valuation_date,\n        cast(nav as decimal(18,2)) as nav,\n        cast(nav_usd as decimal(18,2)) as nav_usd,\n        created_at\n    from source\n    where valuation_date >= '2020-01-01'\n)\n\nselect * from filtered", "relation_name": "BAIN_ANALYTICS.DEV.stg_valuations", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.225271Z", "completed_at": "2026-01-24T22:59:28.227274Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.230398Z", "completed_at": "2026-01-24T22:59:28.230398Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.02936077117919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.sample_benchmarks", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.245088Z", "completed_at": "2026-01-24T22:59:28.247094Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.261215Z", "completed_at": "2026-01-24T22:59:28.261215Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.027878522872924805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.sample_brokers", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.250184Z", "completed_at": "2026-01-24T22:59:28.256187Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.265175Z", "completed_at": "2026-01-24T22:59:28.265175Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.028828144073486328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.sample_cashflows", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.257099Z", "completed_at": "2026-01-24T22:59:28.260182Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.266183Z", "completed_at": "2026-01-24T22:59:28.266183Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027192354202270508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.sample_fund_hierarchy", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.262182Z", "completed_at": "2026-01-24T22:59:28.264197Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.267094Z", "completed_at": "2026-01-24T22:59:28.267094Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.024056196212768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.sample_market_prices", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.280132Z", "completed_at": "2026-01-24T22:59:28.282124Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.293047Z", "completed_at": "2026-01-24T22:59:28.293047Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021836280822753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.sample_portfolio_benchmarks", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.283139Z", "completed_at": "2026-01-24T22:59:28.285115Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.302049Z", "completed_at": "2026-01-24T22:59:28.302049Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.028902292251586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.sample_portfolios", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.286145Z", "completed_at": "2026-01-24T22:59:28.290136Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.305040Z", "completed_at": "2026-01-24T22:59:28.305040Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03000617027282715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.sample_positions_daily", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.296043Z", "completed_at": "2026-01-24T22:59:28.300048Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.309156Z", "completed_at": "2026-01-24T22:59:28.309156Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0329892635345459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.sample_securities", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.321083Z", "completed_at": "2026-01-24T22:59:28.323235Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.338231Z", "completed_at": "2026-01-24T22:59:28.338231Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024064064025878906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.sample_trades", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.324269Z", "completed_at": "2026-01-24T22:59:28.326229Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.342919Z", "completed_at": "2026-01-24T22:59:28.342919Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026790618896484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.bain_capital_portfolio_analytics.sample_valuations", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.327229Z", "completed_at": "2026-01-24T22:59:28.345839Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.351875Z", "completed_at": "2026-01-24T22:59:28.351875Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.034735918045043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_not_null_raw_sample_benchmarks_benchmark_id.ef7db0253c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect benchmark_id\nfrom BAIN_ANALYTICS.DEV.sample_benchmarks\nwhere benchmark_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.338821Z", "completed_at": "2026-01-24T22:59:28.349830Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.353829Z", "completed_at": "2026-01-24T22:59:28.353829Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.034683942794799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_not_null_raw_sample_brokers_broker_id.96e4e75043", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect broker_id\nfrom BAIN_ANALYTICS.DEV.sample_brokers\nwhere broker_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.358488Z", "completed_at": "2026-01-24T22:59:28.374862Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.383782Z", "completed_at": "2026-01-24T22:59:28.383782Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.032945871353149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_not_null_raw_sample_cashflows_cashflow_id.c1b1e6d773", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cashflow_id\nfrom BAIN_ANALYTICS.DEV.sample_cashflows\nwhere cashflow_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.368896Z", "completed_at": "2026-01-24T22:59:28.376781Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.470620Z", "completed_at": "2026-01-24T22:59:28.470620Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.11870503425598145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_not_null_raw_sample_cashflows_portfolio_id.eb72ea03e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect portfolio_id\nfrom BAIN_ANALYTICS.DEV.sample_cashflows\nwhere portfolio_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.376781Z", "completed_at": "2026-01-24T22:59:28.474636Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.481834Z", "completed_at": "2026-01-24T22:59:28.481834Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.11529874801635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_not_null_raw_sample_fund_hierarchy_entity_id.1719789752", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect entity_id\nfrom BAIN_ANALYTICS.DEV.sample_fund_hierarchy\nwhere entity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.384783Z", "completed_at": "2026-01-24T22:59:28.478835Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.485697Z", "completed_at": "2026-01-24T22:59:28.486784Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.11289548873901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_not_null_raw_sample_portfolios_portfolio_id.d6cc8f1cb4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect portfolio_id\nfrom BAIN_ANALYTICS.DEV.sample_portfolios\nwhere portfolio_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.493062Z", "completed_at": "2026-01-24T22:59:28.510061Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.517501Z", "completed_at": "2026-01-24T22:59:28.517501Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03766512870788574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_not_null_raw_sample_positions_daily_position_id.72d2d30023", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect position_id\nfrom BAIN_ANALYTICS.DEV.sample_positions_daily\nwhere position_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.505062Z", "completed_at": "2026-01-24T22:59:28.512061Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.522569Z", "completed_at": "2026-01-24T22:59:28.522569Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03687262535095215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_not_null_raw_sample_securities_security_id.2b1abce5fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect security_id\nfrom BAIN_ANALYTICS.DEV.sample_securities\nwhere security_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.512061Z", "completed_at": "2026-01-24T22:59:28.524552Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.527587Z", "completed_at": "2026-01-24T22:59:28.527587Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02552485466003418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_not_null_raw_sample_trades_trade_id.87413071f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trade_id\nfrom BAIN_ANALYTICS.DEV.sample_trades\nwhere trade_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.517501Z", "completed_at": "2026-01-24T22:59:28.526507Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.528506Z", "completed_at": "2026-01-24T22:59:28.528506Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.01944422721862793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_not_null_raw_sample_valuations_valuation_id.8e2a190042", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect valuation_id\nfrom BAIN_ANALYTICS.DEV.sample_valuations\nwhere valuation_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.532208Z", "completed_at": "2026-01-24T22:59:28.547097Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.557242Z", "completed_at": "2026-01-24T22:59:28.557242Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030734539031982422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_unique_raw_sample_benchmarks_benchmark_id.41406c78b4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    benchmark_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.sample_benchmarks\nwhere benchmark_id is not null\ngroup by benchmark_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.540079Z", "completed_at": "2026-01-24T22:59:28.549096Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.564247Z", "completed_at": "2026-01-24T22:59:28.564247Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03665971755981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_unique_raw_sample_brokers_broker_id.636249ebce", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    broker_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.sample_brokers\nwhere broker_id is not null\ngroup by broker_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.549096Z", "completed_at": "2026-01-24T22:59:28.566231Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.570590Z", "completed_at": "2026-01-24T22:59:28.570590Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.030511856079101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_unique_raw_sample_cashflows_cashflow_id.b558db5773", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cashflow_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.sample_cashflows\nwhere cashflow_id is not null\ngroup by cashflow_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.558247Z", "completed_at": "2026-01-24T22:59:28.567230Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.574500Z", "completed_at": "2026-01-24T22:59:28.574500Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0294036865234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_unique_raw_sample_fund_hierarchy_entity_id.a9746eaae1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    entity_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.sample_fund_hierarchy\nwhere entity_id is not null\ngroup by entity_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.579494Z", "completed_at": "2026-01-24T22:59:28.591495Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.598493Z", "completed_at": "2026-01-24T22:59:28.598493Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030026912689208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_unique_raw_sample_portfolios_portfolio_id.b1809722d7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    portfolio_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.sample_portfolios\nwhere portfolio_id is not null\ngroup by portfolio_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.585497Z", "completed_at": "2026-01-24T22:59:28.593494Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.607356Z", "completed_at": "2026-01-24T22:59:28.607356Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03381991386413574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_unique_raw_sample_positions_daily_position_id.550530e19d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    position_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.sample_positions_daily\nwhere position_id is not null\ngroup by position_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.593494Z", "completed_at": "2026-01-24T22:59:28.610375Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.614281Z", "completed_at": "2026-01-24T22:59:28.614281Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02978682518005371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_unique_raw_sample_securities_security_id.a3549d9277", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    security_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.sample_securities\nwhere security_id is not null\ngroup by security_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.599494Z", "completed_at": "2026-01-24T22:59:28.611266Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.615264Z", "completed_at": "2026-01-24T22:59:28.615264Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.02577042579650879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_unique_raw_sample_trades_trade_id.3713acfd5c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    trade_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.sample_trades\nwhere trade_id is not null\ngroup by trade_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.619262Z", "completed_at": "2026-01-24T22:59:28.636271Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.642033Z", "completed_at": "2026-01-24T22:59:28.642033Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02976846694946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.source_unique_raw_sample_valuations_valuation_id.c2f985557f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    valuation_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.sample_valuations\nwhere valuation_id is not null\ngroup by valuation_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.625272Z", "completed_at": "2026-01-24T22:59:28.637270Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.649506Z", "completed_at": "2026-01-24T22:59:28.649506Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03324151039123535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.accepted_values_stg_cashflows_cashflow_type__CONTRIBUTION__DISTRIBUTION__DIVIDEND__FEE.d3b48fa192", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        cashflow_type as value_field,\n        count(*) as n_records\n\n    from BAIN_ANALYTICS.DEV.stg_cashflows\n    group by cashflow_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'CONTRIBUTION','DISTRIBUTION','DIVIDEND','FEE'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.638270Z", "completed_at": "2026-01-24T22:59:28.651499Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.653502Z", "completed_at": "2026-01-24T22:59:28.653502Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.030228376388549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_cashflows_amount.333b517880", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom BAIN_ANALYTICS.DEV.stg_cashflows\nwhere amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.643032Z", "completed_at": "2026-01-24T22:59:28.652582Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.655531Z", "completed_at": "2026-01-24T22:59:28.655531Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.031261444091796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_cashflows_cashflow_date.d05a251154", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cashflow_date\nfrom BAIN_ANALYTICS.DEV.stg_cashflows\nwhere cashflow_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.658594Z", "completed_at": "2026-01-24T22:59:28.669498Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.676582Z", "completed_at": "2026-01-24T22:59:28.676582Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023079872131347656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_cashflows_cashflow_id.4176024898", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cashflow_id\nfrom BAIN_ANALYTICS.DEV.stg_cashflows\nwhere cashflow_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.664531Z", "completed_at": "2026-01-24T22:59:28.671583Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.690598Z", "completed_at": "2026-01-24T22:59:28.690598Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03710818290710449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_cashflows_portfolio_id.cbd1d93e57", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect portfolio_id\nfrom BAIN_ANALYTICS.DEV.stg_cashflows\nwhere portfolio_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.672592Z", "completed_at": "2026-01-24T22:59:28.692540Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.698549Z", "completed_at": "2026-01-24T22:59:28.698549Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03495645523071289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.unique_stg_cashflows_cashflow_id.359e4f4704", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cashflow_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.stg_cashflows\nwhere cashflow_id is not null\ngroup by cashflow_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.677588Z", "completed_at": "2026-01-24T22:59:28.697505Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.700582Z", "completed_at": "2026-01-24T22:59:28.700582Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03200531005859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.dbt_utils_accepted_range_stg_market_prices_close_price__0.e3d7513f81", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from BAIN_ANALYTICS.DEV.stg_market_prices\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not close_price >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.704607Z", "completed_at": "2026-01-24T22:59:28.715376Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.721760Z", "completed_at": "2026-01-24T22:59:28.721760Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02321171760559082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_market_prices_close_price.9b82d432ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect close_price\nfrom BAIN_ANALYTICS.DEV.stg_market_prices\nwhere close_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.709734Z", "completed_at": "2026-01-24T22:59:28.716383Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.735863Z", "completed_at": "2026-01-24T22:59:28.735863Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03627729415893555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_market_prices_price_date.301b839d0d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price_date\nfrom BAIN_ANALYTICS.DEV.stg_market_prices\nwhere price_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.717754Z", "completed_at": "2026-01-24T22:59:28.737865Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.743456Z", "completed_at": "2026-01-24T22:59:28.743456Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03987002372741699, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_market_prices_security_id.8c3b87bce2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect security_id\nfrom BAIN_ANALYTICS.DEV.stg_market_prices\nwhere security_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.722764Z", "completed_at": "2026-01-24T22:59:28.737865Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.744456Z", "completed_at": "2026-01-24T22:59:28.744456Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.030632495880126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.fact_cashflow_summary", "compiled": true, "compiled_code": "-- Pipeline A: Simple Cashflow Pipeline\n-- Model: fact_cashflow_summary\n-- Description: Fact table summarizing cashflows by portfolio and month\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Heavy join repeated from other facts\n-- 2. Late aggregation (aggregates after full join)\n-- 3. Redundant date calculations\n-- 4. Non-optimal GROUP BY\n\nwith cashflows as (\n    select * from BAIN_ANALYTICS.DEV.stg_cashflows\n),\n\nportfolios as (\n    select * from BAIN_ANALYTICS.DEV.stg_portfolios\n),\n\n-- ISSUE: Full join before aggregation (scans all rows)\njoined as (\n    select\n        c.cashflow_id,\n        c.portfolio_id,\n        p.portfolio_name,\n        p.portfolio_type,\n        p.fund_id,\n        c.cashflow_type,\n        c.cashflow_date,\n        c.amount,\n        c.currency,\n        -- ISSUE: Redundant date calculations done per row\n        date_trunc('month', c.cashflow_date) as cashflow_month,\n        date_trunc('quarter', c.cashflow_date) as cashflow_quarter,\n        date_trunc('year', c.cashflow_date) as cashflow_year,\n        extract(year from c.cashflow_date) as year_num,\n        extract(month from c.cashflow_date) as month_num,\n        extract(quarter from c.cashflow_date) as quarter_num\n    from cashflows c\n    inner join portfolios p\n        on c.portfolio_id = p.portfolio_id\n),\n\n-- ISSUE: Aggregation happens after full row-level join\naggregated as (\n    select\n        portfolio_id,\n        portfolio_name,\n        portfolio_type,\n        fund_id,\n        cashflow_month,\n        cashflow_quarter,\n        cashflow_year,\n        year_num,\n        month_num,\n        quarter_num,\n        cashflow_type,\n        currency,\n        count(*) as transaction_count,\n        sum(amount) as total_amount,\n        avg(amount) as avg_amount,\n        min(amount) as min_amount,\n        max(amount) as max_amount\n    from joined\n    group by 1,2,3,4,5,6,7,8,9,10,11,12  -- ISSUE: Non-descriptive GROUP BY\n)\n\nselect\n    md5(cast(coalesce(cast(portfolio_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cashflow_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cashflow_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(currency as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as cashflow_summary_key,\n    *\nfrom aggregated", "relation_name": "BAIN_ANALYTICS.DEV.fact_cashflow_summary", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.753457Z", "completed_at": "2026-01-24T22:59:28.766858Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.768855Z", "completed_at": "2026-01-24T22:59:28.768855Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02739739418029785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.accepted_values_stg_portfolios_status__ACTIVE__INACTIVE__CLOSED.7c5e49f046", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from BAIN_ANALYTICS.DEV.stg_portfolios\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'ACTIVE','INACTIVE','CLOSED'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.761950Z", "completed_at": "2026-01-24T22:59:28.769854Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.785109Z", "completed_at": "2026-01-24T22:59:28.785109Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.037554264068603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_portfolios_portfolio_id.7126a480ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect portfolio_id\nfrom BAIN_ANALYTICS.DEV.stg_portfolios\nwhere portfolio_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.770857Z", "completed_at": "2026-01-24T22:59:28.786110Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.789112Z", "completed_at": "2026-01-24T22:59:28.789112Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028158903121948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_portfolios_portfolio_name.667840ac9c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect portfolio_name\nfrom BAIN_ANALYTICS.DEV.stg_portfolios\nwhere portfolio_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.775857Z", "completed_at": "2026-01-24T22:59:28.788114Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.791222Z", "completed_at": "2026-01-24T22:59:28.791222Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03026866912841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.relationships_stg_cashflows_portfolio_id__portfolio_id__ref_stg_portfolios_.9f0a1fd1ba", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select portfolio_id as from_field\n    from BAIN_ANALYTICS.DEV.stg_cashflows\n    where portfolio_id is not null\n),\n\nparent as (\n    select portfolio_id as to_field\n    from BAIN_ANALYTICS.DEV.stg_portfolios\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.795694Z", "completed_at": "2026-01-24T22:59:28.806112Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.814142Z", "completed_at": "2026-01-24T22:59:28.814142Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.027032852172851562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.unique_stg_portfolios_portfolio_id.aa125b6658", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    portfolio_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.stg_portfolios\nwhere portfolio_id is not null\ngroup by portfolio_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.807031Z", "completed_at": "2026-01-24T22:59:28.824095Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.833111Z", "completed_at": "2026-01-24T22:59:28.833111Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.039916276931762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_positions_daily_portfolio_id.89e9a34f2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect portfolio_id\nfrom BAIN_ANALYTICS.DEV.stg_positions_daily\nwhere portfolio_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.817110Z", "completed_at": "2026-01-24T22:59:28.834101Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.838103Z", "completed_at": "2026-01-24T22:59:28.838103Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0330047607421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_positions_daily_position_date.c1d30d8c47", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect position_date\nfrom BAIN_ANALYTICS.DEV.stg_positions_daily\nwhere position_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.825104Z", "completed_at": "2026-01-24T22:59:28.836114Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.839610Z", "completed_at": "2026-01-24T22:59:28.839610Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.033498287200927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_positions_daily_position_id.5376c0b852", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect position_id\nfrom BAIN_ANALYTICS.DEV.stg_positions_daily\nwhere position_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.841616Z", "completed_at": "2026-01-24T22:59:28.849616Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.862689Z", "completed_at": "2026-01-24T22:59:28.862689Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.027553558349609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_positions_daily_security_id.3dde029ee5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect security_id\nfrom BAIN_ANALYTICS.DEV.stg_positions_daily\nwhere security_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.851716Z", "completed_at": "2026-01-24T22:59:28.876705Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.879619Z", "completed_at": "2026-01-24T22:59:28.879619Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03999924659729004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.unique_stg_positions_daily_position_id.37818d6471", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    position_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.stg_positions_daily\nwhere position_id is not null\ngroup by position_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.864718Z", "completed_at": "2026-01-24T22:59:28.878659Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.916916Z", "completed_at": "2026-01-24T22:59:28.916916Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06930088996887207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.accepted_values_stg_securities_security_type_standardized__EQUITY__FIXED_INCOME__DERIVATIVE__FUND__OTHER.3e7dc8b60d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        security_type_standardized as value_field,\n        count(*) as n_records\n\n    from BAIN_ANALYTICS.DEV.stg_securities\n    group by security_type_standardized\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'EQUITY','FIXED_INCOME','DERIVATIVE','FUND','OTHER'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.872701Z", "completed_at": "2026-01-24T22:59:28.899618Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.918916Z", "completed_at": "2026-01-24T22:59:28.918916Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06929993629455566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_securities_security_id.f91b0934be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect security_id\nfrom BAIN_ANALYTICS.DEV.stg_securities\nwhere security_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.892617Z", "completed_at": "2026-01-24T22:59:28.919916Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.923953Z", "completed_at": "2026-01-24T22:59:28.923953Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03333592414855957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_securities_ticker.57595820c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticker\nfrom BAIN_ANALYTICS.DEV.stg_securities\nwhere ticker is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.928960Z", "completed_at": "2026-01-24T22:59:28.946089Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.961010Z", "completed_at": "2026-01-24T22:59:28.961010Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.040093421936035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.unique_stg_securities_security_id.92fe74e630", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    security_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.stg_securities\nwhere security_id is not null\ngroup by security_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.947011Z", "completed_at": "2026-01-24T22:59:28.972481Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.974430Z", "completed_at": "2026-01-24T22:59:28.974430Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0474700927734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.accepted_values_stg_trades_trade_category__PURCHASE__SALE__INCOME__OTHER.198f663cac", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        trade_category as value_field,\n        count(*) as n_records\n\n    from BAIN_ANALYTICS.DEV.stg_trades\n    group by trade_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'PURCHASE','SALE','INCOME','OTHER'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.964404Z", "completed_at": "2026-01-24T22:59:28.976616Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:28.979622Z", "completed_at": "2026-01-24T22:59:28.979622Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04166221618652344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.accepted_values_stg_trades_trade_size_bucket__LARGE__MEDIUM__SMALL__MICRO.211accc343", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        trade_size_bucket as value_field,\n        count(*) as n_records\n\n    from BAIN_ANALYTICS.DEV.stg_trades\n    group by trade_size_bucket\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'LARGE','MEDIUM','SMALL','MICRO'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.981625Z", "completed_at": "2026-01-24T22:59:28.995664Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.003624Z", "completed_at": "2026-01-24T22:59:29.003624Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02822256088256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_trades_portfolio_id.2becbd2a0b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect portfolio_id\nfrom BAIN_ANALYTICS.DEV.stg_trades\nwhere portfolio_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.987623Z", "completed_at": "2026-01-24T22:59:29.001624Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.005631Z", "completed_at": "2026-01-24T22:59:29.005631Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028006315231323242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_trades_security_id.86be87f7ab", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect security_id\nfrom BAIN_ANALYTICS.DEV.stg_trades\nwhere security_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:28.996708Z", "completed_at": "2026-01-24T22:59:29.006623Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.017923Z", "completed_at": "2026-01-24T22:59:29.017923Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0381622314453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_trades_trade_date.42ba31e712", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trade_date\nfrom BAIN_ANALYTICS.DEV.stg_trades\nwhere trade_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.007814Z", "completed_at": "2026-01-24T22:59:29.020876Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.025593Z", "completed_at": "2026-01-24T22:59:29.025593Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029929637908935547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_trades_trade_id.f81937320b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trade_id\nfrom BAIN_ANALYTICS.DEV.stg_trades\nwhere trade_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.028592Z", "completed_at": "2026-01-24T22:59:29.048467Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.058542Z", "completed_at": "2026-01-24T22:59:29.058542Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03861093521118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.unique_stg_trades_trade_id.f973ed6ffd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    trade_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.stg_trades\nwhere trade_id is not null\ngroup by trade_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.036675Z", "completed_at": "2026-01-24T22:59:29.058542Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.061461Z", "completed_at": "2026-01-24T22:59:29.061461Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04058527946472168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.dbt_utils_accepted_range_stg_valuations_nav_usd__0.cdcff35ae0", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from BAIN_ANALYTICS.DEV.stg_valuations\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not nav_usd >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.051461Z", "completed_at": "2026-01-24T22:59:29.061461Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.069450Z", "completed_at": "2026-01-24T22:59:29.069450Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.04185366630554199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_valuations_nav_usd.e351b70ae7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nav_usd\nfrom BAIN_ANALYTICS.DEV.stg_valuations\nwhere nav_usd is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.063370Z", "completed_at": "2026-01-24T22:59:29.073408Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.077376Z", "completed_at": "2026-01-24T22:59:29.077376Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02790999412536621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_stg_valuations_valuation_id.88ca70781d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect valuation_id\nfrom BAIN_ANALYTICS.DEV.stg_valuations\nwhere valuation_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.079378Z", "completed_at": "2026-01-24T22:59:29.090387Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.097387Z", "completed_at": "2026-01-24T22:59:29.097387Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.027011632919311523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.unique_stg_valuations_valuation_id.fce7eb13b5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    valuation_id as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.stg_valuations\nwhere valuation_id is not null\ngroup by valuation_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.084488Z", "completed_at": "2026-01-24T22:59:29.092389Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.098387Z", "completed_at": "2026-01-24T22:59:29.098387Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025934934616088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.report_monthly_cashflows", "compiled": true, "compiled_code": "-- Pipeline A: Simple Cashflow Pipeline\n-- Model: report_monthly_cashflows\n-- Description: LP reporting view for monthly cashflow analysis\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Re-aggregates data that's already in fact table\n-- 2. Repeated window functions\n-- 3. Suboptimal pivot pattern\n\nwith fact_data as (\n    select * from BAIN_ANALYTICS.DEV.fact_cashflow_summary\n),\n\n-- ISSUE: Re-aggregating already aggregated data\nmonthly_totals as (\n    select\n        portfolio_id,\n        portfolio_name,\n        portfolio_type,\n        fund_id,\n        cashflow_month,\n        year_num,\n        month_num,\n        sum(case when cashflow_type = 'CONTRIBUTION' then total_amount else 0 end) as contributions,\n        sum(case when cashflow_type = 'DISTRIBUTION' then total_amount else 0 end) as distributions,\n        sum(case when cashflow_type = 'DIVIDEND' then total_amount else 0 end) as dividends,\n        sum(case when cashflow_type = 'FEE' then total_amount else 0 end) as fees,\n        sum(total_amount) as total_cashflow,\n        sum(transaction_count) as total_transactions\n    from fact_data\n    group by 1,2,3,4,5,6,7\n),\n\n-- ISSUE: Window functions recalculated multiple times\nwith_running_totals as (\n    select\n        *,\n        -- Running totals (repeated pattern)\n        sum(contributions) over (\n            partition by portfolio_id\n            order by cashflow_month\n            rows between unbounded preceding and current row\n        ) as cumulative_contributions,\n        sum(distributions) over (\n            partition by portfolio_id\n            order by cashflow_month\n            rows between unbounded preceding and current row\n        ) as cumulative_distributions,\n        sum(total_cashflow) over (\n            partition by portfolio_id\n            order by cashflow_month\n            rows between unbounded preceding and current row\n        ) as cumulative_net_cashflow,\n        -- Prior period comparisons (another repeated pattern)\n        lag(contributions, 1) over (partition by portfolio_id order by cashflow_month) as prior_month_contributions,\n        lag(distributions, 1) over (partition by portfolio_id order by cashflow_month) as prior_month_distributions,\n        lag(total_cashflow, 1) over (partition by portfolio_id order by cashflow_month) as prior_month_total,\n        -- YoY comparison\n        lag(contributions, 12) over (partition by portfolio_id order by cashflow_month) as prior_year_contributions,\n        lag(distributions, 12) over (partition by portfolio_id order by cashflow_month) as prior_year_distributions\n    from monthly_totals\n),\n\n-- ISSUE: Calculated columns that could be simplified\nfinal as (\n    select\n        *,\n        contributions - coalesce(prior_month_contributions, 0) as mom_contribution_change,\n        distributions - coalesce(prior_month_distributions, 0) as mom_distribution_change,\n        case\n            when prior_year_contributions > 0\n            then (contributions - prior_year_contributions) / prior_year_contributions * 100\n            else null\n        end as yoy_contribution_pct_change,\n        contributions - distributions as net_inflow\n    from with_running_totals\n)\n\nselect * from final\norder by portfolio_id, cashflow_month", "relation_name": "BAIN_ANALYTICS.DEV.report_monthly_cashflows", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.093427Z", "completed_at": "2026-01-24T22:59:29.100884Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.108258Z", "completed_at": "2026-01-24T22:59:29.108258Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.029803752899169922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.dbt_utils_accepted_range_fact_cashflow_summary_transaction_count__0.4582b1b384", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from BAIN_ANALYTICS.DEV.fact_cashflow_summary\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not transaction_count >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.100884Z", "completed_at": "2026-01-24T22:59:29.112251Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.117345Z", "completed_at": "2026-01-24T22:59:29.117345Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025956392288208008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_fact_cashflow_summary_cashflow_summary_key.eda3fa76d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cashflow_summary_key\nfrom BAIN_ANALYTICS.DEV.fact_cashflow_summary\nwhere cashflow_summary_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.118276Z", "completed_at": "2026-01-24T22:59:29.129345Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.156922Z", "completed_at": "2026-01-24T22:59:29.156922Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04958534240722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_fact_cashflow_summary_portfolio_id.625a7cad74", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect portfolio_id\nfrom BAIN_ANALYTICS.DEV.fact_cashflow_summary\nwhere portfolio_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.123252Z", "completed_at": "2026-01-24T22:59:29.130422Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.159922Z", "completed_at": "2026-01-24T22:59:29.159922Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04866504669189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.unique_fact_cashflow_summary_cashflow_summary_key.b4868fe991", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cashflow_summary_key as unique_field,\n    count(*) as n_records\n\nfrom BAIN_ANALYTICS.DEV.fact_cashflow_summary\nwhere cashflow_summary_key is not null\ngroup by cashflow_summary_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.162906Z", "completed_at": "2026-01-24T22:59:29.172973Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.174975Z", "completed_at": "2026-01-24T22:59:29.174975Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04455304145812988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_int_trades_enriched_trade_id.ffac9962a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_trades_enriched as (\n-- Pipeline B: Trade Analytics Pipeline\n-- Model: int_trades_enriched\n-- Description: Intermediate model enriching trades with security and price data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Multiple heavy joins done row-by-row\n-- 2. Price lookup repeated for every trade\n-- 3. Could pre-aggregate before joining\n\nwith trades as (\n    select * from BAIN_ANALYTICS.DEV.stg_trades\n),\n\nsecurities as (\n    select * from BAIN_ANALYTICS.DEV.stg_securities\n),\n\nmarket_prices as (\n    select * from BAIN_ANALYTICS.DEV.stg_market_prices\n),\n\nbrokers as (\n    select * from BAIN_ANALYTICS.DEV.stg_brokers\n),\n\n-- ISSUE: Heavy multi-way join before any aggregation\nenriched as (\n    select\n        t.trade_id,\n        t.portfolio_id,\n        t.security_id,\n        t.trade_date,\n        t.trade_type,\n        t.trade_category,\n        t.trade_size_bucket,\n        t.quantity,\n        t.price as execution_price,\n        t.net_amount,\n        t.currency,\n        t.trade_month,\n        t.trade_quarter,\n        t.trade_year,\n        t.trade_type_clean,\n        -- Security attributes\n        s.ticker,\n        s.security_name,\n        s.security_type_standardized as security_type,\n        s.asset_class,\n        s.sector,\n        s.industry,\n        s.country as security_country,\n        -- Broker attributes\n        b.broker_name,\n        b.created_at as broker_created_at\n    from trades t\n    inner join securities s\n        on t.security_id = s.security_id\n    left join brokers b\n        on t.broker_id = b.broker_id\n)\n\nselect * from enriched\n) select trade_id\nfrom __dbt__cte__int_trades_enriched\nwhere trade_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.175974Z", "completed_at": "2026-01-24T22:59:29.203000Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.206975Z", "completed_at": "2026-01-24T22:59:29.206975Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0370023250579834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.unique_int_trades_enriched_trade_id.3338eab4a7", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_trades_enriched as (\n-- Pipeline B: Trade Analytics Pipeline\n-- Model: int_trades_enriched\n-- Description: Intermediate model enriching trades with security and price data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Multiple heavy joins done row-by-row\n-- 2. Price lookup repeated for every trade\n-- 3. Could pre-aggregate before joining\n\nwith trades as (\n    select * from BAIN_ANALYTICS.DEV.stg_trades\n),\n\nsecurities as (\n    select * from BAIN_ANALYTICS.DEV.stg_securities\n),\n\nmarket_prices as (\n    select * from BAIN_ANALYTICS.DEV.stg_market_prices\n),\n\nbrokers as (\n    select * from BAIN_ANALYTICS.DEV.stg_brokers\n),\n\n-- ISSUE: Heavy multi-way join before any aggregation\nenriched as (\n    select\n        t.trade_id,\n        t.portfolio_id,\n        t.security_id,\n        t.trade_date,\n        t.trade_type,\n        t.trade_category,\n        t.trade_size_bucket,\n        t.quantity,\n        t.price as execution_price,\n        t.net_amount,\n        t.currency,\n        t.trade_month,\n        t.trade_quarter,\n        t.trade_year,\n        t.trade_type_clean,\n        -- Security attributes\n        s.ticker,\n        s.security_name,\n        s.security_type_standardized as security_type,\n        s.asset_class,\n        s.sector,\n        s.industry,\n        s.country as security_country,\n        -- Broker attributes\n        b.broker_name,\n        b.created_at as broker_created_at\n    from trades t\n    inner join securities s\n        on t.security_id = s.security_id\n    left join brokers b\n        on t.broker_id = b.broker_id\n)\n\nselect * from enriched\n) select\n    trade_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_trades_enriched\nwhere trade_id is not null\ngroup by trade_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.187068Z", "completed_at": "2026-01-24T22:59:29.205998Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.209978Z", "completed_at": "2026-01-24T22:59:29.209978Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03800463676452637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.assert_cashflow_balance", "compiled": true, "compiled_code": "-- Test: Cashflow totals should balance at portfolio level\n-- Validates that contributions - distributions = net cashflow\n\nwith cashflow_totals as (\n    select\n        portfolio_id,\n        sum(contributions) as total_contributions,\n        sum(distributions) as total_distributions,\n        sum(net_inflow) as total_net_inflow\n    from BAIN_ANALYTICS.DEV.report_monthly_cashflows\n    group by portfolio_id\n)\n\nselect *\nfrom cashflow_totals\nwhere abs(total_contributions - total_distributions - total_net_inflow) > 0.01", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.193975Z", "completed_at": "2026-01-24T22:59:29.207975Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.211973Z", "completed_at": "2026-01-24T22:59:29.211973Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03799843788146973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_report_monthly_cashflows_portfolio_id.dbc5367687", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect portfolio_id\nfrom BAIN_ANALYTICS.DEV.report_monthly_cashflows\nwhere portfolio_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.215030Z", "completed_at": "2026-01-24T22:59:29.229186Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.233283Z", "completed_at": "2026-01-24T22:59:29.233283Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.028308868408203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.assert_realized_pnl_only_on_sales", "compiled": true, "compiled_code": "with __dbt__cte__int_trades_enriched as (\n-- Pipeline B: Trade Analytics Pipeline\n-- Model: int_trades_enriched\n-- Description: Intermediate model enriching trades with security and price data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Multiple heavy joins done row-by-row\n-- 2. Price lookup repeated for every trade\n-- 3. Could pre-aggregate before joining\n\nwith trades as (\n    select * from BAIN_ANALYTICS.DEV.stg_trades\n),\n\nsecurities as (\n    select * from BAIN_ANALYTICS.DEV.stg_securities\n),\n\nmarket_prices as (\n    select * from BAIN_ANALYTICS.DEV.stg_market_prices\n),\n\nbrokers as (\n    select * from BAIN_ANALYTICS.DEV.stg_brokers\n),\n\n-- ISSUE: Heavy multi-way join before any aggregation\nenriched as (\n    select\n        t.trade_id,\n        t.portfolio_id,\n        t.security_id,\n        t.trade_date,\n        t.trade_type,\n        t.trade_category,\n        t.trade_size_bucket,\n        t.quantity,\n        t.price as execution_price,\n        t.net_amount,\n        t.currency,\n        t.trade_month,\n        t.trade_quarter,\n        t.trade_year,\n        t.trade_type_clean,\n        -- Security attributes\n        s.ticker,\n        s.security_name,\n        s.security_type_standardized as security_type,\n        s.asset_class,\n        s.sector,\n        s.industry,\n        s.country as security_country,\n        -- Broker attributes\n        b.broker_name,\n        b.created_at as broker_created_at\n    from trades t\n    inner join securities s\n        on t.security_id = s.security_id\n    left join brokers b\n        on t.broker_id = b.broker_id\n)\n\nselect * from enriched\n),  __dbt__cte__int_trade_pnl as (\n-- Pipeline B: Trade Analytics Pipeline\n-- Model: int_trade_pnl\n-- Description: Calculate P&L for each trade\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Complex position tracking logic that could be simplified\n-- 2. Multiple self-joins for cost basis calculation\n-- 3. Window functions recalculated multiple times\n\nwith trades as (\n    select * from __dbt__cte__int_trades_enriched\n),\n\n-- ISSUE: Running position calculation done inefficiently\npositions as (\n    select\n        trade_id,\n        portfolio_id,\n        security_id,\n        ticker,\n        trade_date,\n        trade_type,\n        trade_category,\n        quantity,\n        execution_price,\n        net_amount,\n        -- ISSUE: Multiple window functions with same partition\n        sum(case\n            when trade_category = 'PURCHASE' then quantity\n            when trade_category = 'SALE' then -quantity\n            else 0\n        end) over (\n            partition by portfolio_id, security_id\n            order by trade_date, trade_id\n            rows between unbounded preceding and current row\n        ) as running_position,\n        sum(case when trade_category = 'PURCHASE' then quantity else 0 end) over (\n            partition by portfolio_id, security_id\n            order by trade_date, trade_id\n            rows between unbounded preceding and current row\n        ) as cumulative_purchased_qty,\n        sum(case when trade_category = 'PURCHASE' then net_amount else 0 end) over (\n            partition by portfolio_id, security_id\n            order by trade_date, trade_id\n            rows between unbounded preceding and current row\n        ) as cumulative_purchase_cost\n    from trades\n),\n\n-- ISSUE: Separate CTE for cost basis\nwith_cost_basis as (\n    select\n        *,\n        case\n            when cumulative_purchased_qty > 0\n            then cumulative_purchase_cost / cumulative_purchased_qty\n            else null\n        end as avg_cost_basis\n    from positions\n),\n\n-- ISSUE: Another pass for realized P&L\nwith_pnl as (\n    select\n        *,\n        case\n            when trade_category = 'SALE' and avg_cost_basis is not null\n            then (execution_price - avg_cost_basis) * quantity\n            else null\n        end as realized_pnl,\n        case\n            when trade_category = 'SALE' and avg_cost_basis is not null and avg_cost_basis > 0\n            then (execution_price - avg_cost_basis) / avg_cost_basis * 100\n            else null\n        end as realized_pnl_pct\n    from with_cost_basis\n)\n\nselect * from with_pnl\n) -- Test: Realized P&L should only exist for SALE trades\n\nselect *\nfrom __dbt__cte__int_trade_pnl\nwhere trade_category != 'SALE'\n  and realized_pnl is not null\n  and realized_pnl != 0", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.234267Z", "completed_at": "2026-01-24T22:59:29.249692Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.250743Z", "completed_at": "2026-01-24T22:59:29.250743Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02556633949279785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.not_null_int_trade_pnl_trade_id.1759a8439d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_trades_enriched as (\n-- Pipeline B: Trade Analytics Pipeline\n-- Model: int_trades_enriched\n-- Description: Intermediate model enriching trades with security and price data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Multiple heavy joins done row-by-row\n-- 2. Price lookup repeated for every trade\n-- 3. Could pre-aggregate before joining\n\nwith trades as (\n    select * from BAIN_ANALYTICS.DEV.stg_trades\n),\n\nsecurities as (\n    select * from BAIN_ANALYTICS.DEV.stg_securities\n),\n\nmarket_prices as (\n    select * from BAIN_ANALYTICS.DEV.stg_market_prices\n),\n\nbrokers as (\n    select * from BAIN_ANALYTICS.DEV.stg_brokers\n),\n\n-- ISSUE: Heavy multi-way join before any aggregation\nenriched as (\n    select\n        t.trade_id,\n        t.portfolio_id,\n        t.security_id,\n        t.trade_date,\n        t.trade_type,\n        t.trade_category,\n        t.trade_size_bucket,\n        t.quantity,\n        t.price as execution_price,\n        t.net_amount,\n        t.currency,\n        t.trade_month,\n        t.trade_quarter,\n        t.trade_year,\n        t.trade_type_clean,\n        -- Security attributes\n        s.ticker,\n        s.security_name,\n        s.security_type_standardized as security_type,\n        s.asset_class,\n        s.sector,\n        s.industry,\n        s.country as security_country,\n        -- Broker attributes\n        b.broker_name,\n        b.created_at as broker_created_at\n    from trades t\n    inner join securities s\n        on t.security_id = s.security_id\n    left join brokers b\n        on t.broker_id = b.broker_id\n)\n\nselect * from enriched\n),  __dbt__cte__int_trade_pnl as (\n-- Pipeline B: Trade Analytics Pipeline\n-- Model: int_trade_pnl\n-- Description: Calculate P&L for each trade\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Complex position tracking logic that could be simplified\n-- 2. Multiple self-joins for cost basis calculation\n-- 3. Window functions recalculated multiple times\n\nwith trades as (\n    select * from __dbt__cte__int_trades_enriched\n),\n\n-- ISSUE: Running position calculation done inefficiently\npositions as (\n    select\n        trade_id,\n        portfolio_id,\n        security_id,\n        ticker,\n        trade_date,\n        trade_type,\n        trade_category,\n        quantity,\n        execution_price,\n        net_amount,\n        -- ISSUE: Multiple window functions with same partition\n        sum(case\n            when trade_category = 'PURCHASE' then quantity\n            when trade_category = 'SALE' then -quantity\n            else 0\n        end) over (\n            partition by portfolio_id, security_id\n            order by trade_date, trade_id\n            rows between unbounded preceding and current row\n        ) as running_position,\n        sum(case when trade_category = 'PURCHASE' then quantity else 0 end) over (\n            partition by portfolio_id, security_id\n            order by trade_date, trade_id\n            rows between unbounded preceding and current row\n        ) as cumulative_purchased_qty,\n        sum(case when trade_category = 'PURCHASE' then net_amount else 0 end) over (\n            partition by portfolio_id, security_id\n            order by trade_date, trade_id\n            rows between unbounded preceding and current row\n        ) as cumulative_purchase_cost\n    from trades\n),\n\n-- ISSUE: Separate CTE for cost basis\nwith_cost_basis as (\n    select\n        *,\n        case\n            when cumulative_purchased_qty > 0\n            then cumulative_purchase_cost / cumulative_purchased_qty\n            else null\n        end as avg_cost_basis\n    from positions\n),\n\n-- ISSUE: Another pass for realized P&L\nwith_pnl as (\n    select\n        *,\n        case\n            when trade_category = 'SALE' and avg_cost_basis is not null\n            then (execution_price - avg_cost_basis) * quantity\n            else null\n        end as realized_pnl,\n        case\n            when trade_category = 'SALE' and avg_cost_basis is not null and avg_cost_basis > 0\n            then (execution_price - avg_cost_basis) / avg_cost_basis * 100\n            else null\n        end as realized_pnl_pct\n    from with_cost_basis\n)\n\nselect * from with_pnl\n) select trade_id\nfrom __dbt__cte__int_trade_pnl\nwhere trade_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T22:59:29.242695Z", "completed_at": "2026-01-24T22:59:29.251696Z"}, {"name": "execute", "started_at": "2026-01-24T22:59:29.252693Z", "completed_at": "2026-01-24T22:59:29.252693Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02450728416442871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bain_capital_portfolio_analytics.unique_int_trade_pnl_trade_id.9793685b9e", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_trades_enriched as (\n-- Pipeline B: Trade Analytics Pipeline\n-- Model: int_trades_enriched\n-- Description: Intermediate model enriching trades with security and price data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Multiple heavy joins done row-by-row\n-- 2. Price lookup repeated for every trade\n-- 3. Could pre-aggregate before joining\n\nwith trades as (\n    select * from BAIN_ANALYTICS.DEV.stg_trades\n),\n\nsecurities as (\n    select * from BAIN_ANALYTICS.DEV.stg_securities\n),\n\nmarket_prices as (\n    select * from BAIN_ANALYTICS.DEV.stg_market_prices\n),\n\nbrokers as (\n    select * from BAIN_ANALYTICS.DEV.stg_brokers\n),\n\n-- ISSUE: Heavy multi-way join before any aggregation\nenriched as (\n    select\n        t.trade_id,\n        t.portfolio_id,\n        t.security_id,\n        t.trade_date,\n        t.trade_type,\n        t.trade_category,\n        t.trade_size_bucket,\n        t.quantity,\n        t.price as execution_price,\n        t.net_amount,\n        t.currency,\n        t.trade_month,\n        t.trade_quarter,\n        t.trade_year,\n        t.trade_type_clean,\n        -- Security attributes\n        s.ticker,\n        s.security_name,\n        s.security_type_standardized as security_type,\n        s.asset_class,\n        s.sector,\n        s.industry,\n        s.country as security_country,\n        -- Broker attributes\n        b.broker_name,\n        b.created_at as broker_created_at\n    from trades t\n    inner join securities s\n        on t.security_id = s.security_id\n    left join brokers b\n        on t.broker_id = b.broker_id\n)\n\nselect * from enriched\n),  __dbt__cte__int_trade_pnl as (\n-- Pipeline B: Trade Analytics Pipeline\n-- Model: int_trade_pnl\n-- Description: Calculate P&L for each trade\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Complex position tracking logic that could be simplified\n-- 2. Multiple self-joins for cost basis calculation\n-- 3. Window functions recalculated multiple times\n\nwith trades as (\n    select * from __dbt__cte__int_trades_enriched\n),\n\n-- ISSUE: Running position calculation done inefficiently\npositions as (\n    select\n        trade_id,\n        portfolio_id,\n        security_id,\n        ticker,\n        trade_date,\n        trade_type,\n        trade_category,\n        quantity,\n        execution_price,\n        net_amount,\n        -- ISSUE: Multiple window functions with same partition\n        sum(case\n            when trade_category = 'PURCHASE' then quantity\n            when trade_category = 'SALE' then -quantity\n            else 0\n        end) over (\n            partition by portfolio_id, security_id\n            order by trade_date, trade_id\n            rows between unbounded preceding and current row\n        ) as running_position,\n        sum(case when trade_category = 'PURCHASE' then quantity else 0 end) over (\n            partition by portfolio_id, security_id\n            order by trade_date, trade_id\n            rows between unbounded preceding and current row\n        ) as cumulative_purchased_qty,\n        sum(case when trade_category = 'PURCHASE' then net_amount else 0 end) over (\n            partition by portfolio_id, security_id\n            order by trade_date, trade_id\n            rows between unbounded preceding and current row\n        ) as cumulative_purchase_cost\n    from trades\n),\n\n-- ISSUE: Separate CTE for cost basis\nwith_cost_basis as (\n    select\n        *,\n        case\n            when cumulative_purchased_qty > 0\n            then cumulative_purchase_cost / cumulative_purchased_qty\n            else null\n        end as avg_cost_basis\n    from positions\n),\n\n-- ISSUE: Another pass for realized P&L\nwith_pnl as (\n    select\n        *,\n        case\n            when trade_category = 'SALE' and avg_cost_basis is not null\n            then (execution_price - avg_cost_basis) * quantity\n            else null\n        end as realized_pnl,\n        case\n            when trade_category = 'SALE' and avg_cost_basis is not null and avg_cost_basis > 0\n            then (execution_price - avg_cost_basis) / avg_cost_basis * 100\n            else null\n        end as realized_pnl_pct\n    from with_cost_basis\n)\n\nselect * from with_pnl\n) select\n    trade_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_trade_pnl\nwhere trade_id is not null\ngroup by trade_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 5.665104627609253, "args": {"log_level": "info", "invocation_command": "dbt docs generate --quiet", "print": true, "partial_parse_file_diff": true, "cache_selected_only": false, "static": false, "empty_catalog": false, "log_level_file": "debug", "require_unique_project_resource_names": false, "log_path": "i:\\dianababaei\\dbt\\sample-dbt-project\\logs", "require_resource_names_without_spaces": true, "version_check": true, "compile": true, "show_all_deprecations": false, "use_colors_file": true, "require_all_warnings_handled_by_warn_error": false, "quiet": true, "printer_width": 80, "use_colors": true, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "project_dir": "i:\\dianababaei\\dbt\\sample-dbt-project", "require_generic_test_arguments_property": true, "require_yaml_configuration_for_mf_time_spines": false, "profiles_dir": "i:\\dianababaei\\dbt\\sample-dbt-project", "log_file_max_bytes": 10485760, "state_modified_compare_more_unrendered_values": false, "send_anonymous_usage_stats": true, "partial_parse": true, "require_nested_cumulative_type_params": false, "strict_mode": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "source_freshness_run_project_hooks": true, "introspect": true, "macro_debugging": false, "show_resource_report": false, "defer": false, "validate_macro_args": false, "populate_cache": true, "use_fast_test_edges": false, "log_format_file": "debug", "write_json": true, "state_modified_compare_vars": false, "select": [], "require_batched_execution_for_custom_microbatch_strategy": false, "require_ref_searches_node_package_before_root": false, "indirect_selection": "eager", "exclude": [], "skip_nodes_if_on_run_start_fails": false, "static_parser": true, "upload_to_artifacts_ingest_api": false, "vars": {}, "favor_state": false, "which": "generate"}}